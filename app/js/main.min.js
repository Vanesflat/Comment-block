import{showEmptyMessage}from"./empty-message.js";import{validateCommentField,validateNameField}from"./validate.js";import{renderComment}from"./comment.js";const field=document.querySelector(".comments__list"),nameField=document.querySelector(".form__name"),commentField=document.querySelector(".form__text"),dateField=document.querySelector(".form__date"),submitBtn=document.querySelector(".form__btn");let comments=[];function loadComments(){localStorage.getItem("comments")&&(comments=JSON.parse(localStorage.getItem("comments")),comments.forEach((e=>{renderComment(field,e)}))),showEmptyMessage(field,comments)}function fieldClickHandler(e){const t=e.target.closest(".comment"),m=e.target.closest(".comment__btn-like"),n=e.target.closest(".comment__btn-delete");if(m){const e=comments.find((e=>e.id===+t.dataset.id));e.favorite=!e.favorite,localStorage.setItem("comments",JSON.stringify(comments)),m.classList.toggle("comment__btn-like--active")}n&&(comments=comments.filter((e=>e.id!==+t.dataset.id)),localStorage.setItem("comments",JSON.stringify(comments)),t.remove(),showEmptyMessage(field,comments))}function submitBtnClickHandler(e){if(e.preventDefault(),validateNameField(nameField),validateCommentField(commentField),nameField.classList.contains("invalid")||commentField.classList.contains("invalid"))return;const t={id:Date.now(),name:nameField.value,text:commentField.value,date:dateField.value||Date.now(),favorite:!1};comments.push(t),localStorage.setItem("comments",JSON.stringify(comments)),renderComment(field,t),showEmptyMessage(field,comments),nameField.value="",commentField.value="",dateField.value=""}loadComments(),field.addEventListener("click",fieldClickHandler),submitBtn.addEventListener("click",submitBtnClickHandler),nameField.addEventListener("input",(()=>validateNameField(nameField))),commentField.addEventListener("input",(()=>validateCommentField(commentField)));